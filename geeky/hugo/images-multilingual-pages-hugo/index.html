<!doctype html>
<html lang="en" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/WebPage">
    <head>
                <title>
            Including Images in Multilingual Pages with Hugo
        </title>
        <meta name="description" content="Images and multilingual image captions: minimum of editing, maximum reliability">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <link rel="stylesheet" href="/css/perldoc.css">
        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/gdpr.css">
        <script async src="/js/hamburger.js"></script>
        <script async src="/js/gdpr.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-162948019-2"></script>
        











<meta name="twitter:card" content="summary">
<meta property="og:type" content="article">

<meta itemprop="name" property="og:title" content="Including Images in Multilingual Pages with Hugo">
<meta id="meta-descr" itemprop="description" property="og:description" content="Images and multilingual image captions: minimum of editing, maximum reliability">
<meta itemprop="image" property="og:image" content="">
<meta id="meta-published" itemprop="datePublished" content="2020-05-31T19:15:26+02:00">
<meta id="meta-modified" itemprop="dateModified" content="2020-07-21T07:36:24+02:00">

<meta property="og:url" content="https://vendelin.org/geeky/hugo/images-multilingual-pages-hugo/">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="vendelin.org">
<meta property="og:image:alt" content="">



    </head>
    <body itemscope itemtype="http://schema.org/WebPage">
        <nav class="top">
            <a href="javascript:void(0);" class="box-shadow-menu" onclick="menuDrop()" title="Menu"></a>
            <a href="https://vendelin.org" class="logo">
                vendelin.org 
            </a>
        </nav>
        <div id="mobile-menu"></div>
        <div class="page">
            <nav class="breadcrumbs">
<ol itemprop="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
<meta itemprop="name" content="Breadcrumbs">
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://vendelin.org/">
        <meta itemprop="position" content="1">
        <span itemprop="name" class="micro">Home</span></a><span class="col">:</span></li>
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://vendelin.org/geeky/">
        <meta itemprop="position" content="2">
        <span itemprop="name" class="micro">Geeky Stuff</span></a><span class="col">:</span></li>
<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
    <a itemprop="item" href="https://vendelin.org/geeky/hugo/">
        <meta itemprop="position" content="3">
        <span itemprop="name" class="micro">Hugo Cookbook for a Multilingual Site</span></a></li>
</ol>
</nav>
            <main class="container"><div class="grid-left"><nav class="menu" id="authors">

<a href="https://vendelin.org/authors/tvendelin/">
    <div class="author" itemprop="author" id="author-tvendelin" itemscope itemtype="http://schema.org/Person">
        <link href="https://vendelin.org/authors/tvendelin/" rel="author">
    
    <figure>
        <img src="https://vendelin.org/img/tvendelin.jpg" alt="" itemprop="image">
    </figure><div class="name" itemprop="name">
        Toomas Vendelin
    </div>
</div>
</a></nav><nav class="menu" id="ndrop">
        <div class="section">Sections:</div>

        <ul><li><a href="https://vendelin.org/geeky/">Geeky Stuff</a></li>
        <li><a href="https://vendelin.org/travel/">Travel Accounts</a></li>
        <li><a href="https://vendelin.org/about/">About</a></li></ul>
    </nav>
</div>











<article class="main-single"  itemscope itemtype="http://schema.org/Article" itemref="meta-descr meta-published meta-modified author-tvendelin">
    <meta itemprop="mainEntityOfPage" content="https://vendelin.org/geeky/hugo/images-multilingual-pages-hugo/">
        <h1 itemprop="headline">Including Images in Multilingual Pages with Hugo</h1>
        
        <p>Including images in multilingual context is a tricky business. The problem is, an image is a piece of
content in its own right, with its own attributes, most important being the caption, which for N
languages translates into N captions. In a typical editorial workflow, photos and articles come from
two different types of sources (photographers and writers, respectively), and it is a photographer,
who writes the captions – in one language at least.</p>
<p>It&rsquo;s usually an editor who decides, which images to use with which article. And sometimes, the same
image might be used by more than one article. So, the number of places to edit to change anything
about a single image can grow quite quickly.</p>
<p>Of course, if you run your site single-handed, and all images are made by you, the problem is not
that sharp. So, let&rsquo;s start with</p>
<h2 id="a-simple-approach">A Simple Approach</h2>
<p>Markdown allows for the following:</p>
<div class="highlight"><pre class="chroma"><code class="language-md" data-lang="md">![<span class="nt">&#34;alt attribute&#34;</span>](<span class="na">/img/IMAG0024.jpg &#34;title attribute&#34;</span>)
</code></pre></div><p>This translates into</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/img/IMAG0024.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;alt attribute&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;title attribute&#34;</span><span class="p">&gt;</span>
</code></pre></div><p>But we probably want to translate it into something like</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">figure</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/img/IMAG0024.jpg&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;alt attribute&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;title attribute&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">figcaption</span><span class="p">&gt;</span>
        title attribute
    <span class="p">&lt;/</span><span class="nt">figcaption</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">figure</span><span class="p">&gt;</span>
</code></pre></div><p>To make this happen, create a file <code>themes/&lt;YOUR THEME&gt;/layouts/_default/_markup/render-image.html</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">figure</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;main&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;{{ .Destination }}&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{{ .Text }}&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;{{ .Title }}&#34;</span><span class="p">&gt;</span>
    {{- with .Title }}
    <span class="p">&lt;</span><span class="nt">figcaption</span><span class="p">&gt;</span>
        {{.}}
    <span class="p">&lt;/</span><span class="nt">figcaption</span><span class="p">&gt;</span>
    {{ end -}} 
<span class="p">&lt;/</span><span class="nt">figure</span><span class="p">&gt;</span>
</code></pre></div><p>This is called a <a href="https://gohugo.io/getting-started/configuration-markup#markdown-render-hooks" target="_blank" rel="noopener">markup render hook</a>

and is a very new addition as of this writing. Best of all, you can define custom hooks per content
type (more on that in a <a href="https://vendelin.org/geeky/hugo/layout-customize-hugo/">later chapter</a>
).</p>
<p>The editing is still a bit of a hurdle: imagine, step by step, the process of changing a single
image in an article with four language versions. And changing it back ten minutes later, as you
change your mind. Four languages = four edits! And watch out for image-caption mismatches – this can
lead to hilarious (or embarrassing) situations.</p>
<p>Ideally, I&rsquo;d prefer to have&hellip; Let&rsquo;s call it a &lsquo;composite page resource&rsquo;.</p>
<h2 id="a-composite-page-resource">A Composite Page Resource</h2>
<p>The idea is to create a unit containing an image and associated texts translations, and then include
such unit(s) as a resource into a page bundle with minimal effort as a whole. This is more or less
the way you switch the Hugo theme for your project by changing a single configuration parameter.</p>
<p>Let&rsquo;s create an <code>images</code> directory inside our website project, and in this directory for
each image that we might consider to use, let&rsquo;s create a sub-directory containing the image file
itself and the captions in all necessary languages:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">images/
└── tantan
    ├── IMAG0024.jpg
    ├── caption.md
    └── caption.ru.md
</code></pre></div><p>Tantan is a Moroccan town, often considered &lsquo;the gateway&rsquo; to West Sahara, just if you are curious.</p>
<p><del>Now, in our page bundle directory, let&rsquo;s create a symlink:</del></p>
<p>Now, recursively copy the &lsquo;composite bundle&rsquo; you want to include in a page into the page bundle
directory:</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">cp -R &lt;RELATIVE PATH TO PROJECT ROOT&gt;/images/tantan &lt;PATH TO PAGE BUNDLE&gt;/main-image
</code></pre></div><p>Let&rsquo;s create an image markup hook (empty lines are for better legibility and can be removed, of
course):</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">{{- $link := .Destination -}}
{{- $alt := .Text -}}
{{- $cap := .Title -}}

{{- if and (not (path.Ext .Destination)) -}} 
{{- $link = (.Page.Resources.GetMatch (print .Destination &#34;/*.jpg&#34;)).Permalink -}}
{{- if not $cap -}}
{{- with .Page.Resources.GetMatch (print .Destination &#34;/caption.*&#34;) -}}
{{- $cap = chomp .Plain -}}
{{- end -}}
{{- end -}}

{{- if not $alt }}{{ $alt = $cap }}{{ end }}
{{- end -}}

{{- with $link -}}
<span class="p">&lt;</span><span class="nt">figure</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;{{ . }}&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{{ $alt }}&#34;</span><span class="p">&gt;</span>
    {{- with $cap -}}
    <span class="p">&lt;</span><span class="nt">figcaption</span><span class="p">&gt;</span>
        {{ . }}
    <span class="p">&lt;/</span><span class="nt">figcaption</span><span class="p">&gt;</span>
    {{- end -}}
<span class="p">&lt;/</span><span class="nt">figure</span><span class="p">&gt;</span>
{{- end -}}
</code></pre></div><p>If the image URL has &lsquo;extension&rsquo;, that would mean we render everything as
we did in the previous section. Otherwise, we consider it should be
a directory with an image and its captions.</p>
<p>Finally, let&rsquo;s refer to our image from the content file:</p>
<div class="highlight"><pre class="chroma"><code class="language-md" data-lang="md">![](main-img)
</code></pre></div><p>We can also override the captions in the Markdown if need be:</p>
<div class="highlight"><pre class="chroma"><code class="language-md" data-lang="md">![<span class="nt">overriding alt text</span>](<span class="na">main-img &#34;overriding title&#34;</span>)
</code></pre></div><p>The captions are now unambiguously related to the image. Best of all, if we want to use a different
image, all we need is to replace one subdirectory with another. This also guards us against the embarrassments of using
a wrong caption. On the other hand, for simpler cases – like including screenshots in a tutorial –
the Markdown syntax can be used as usual.</p>
<h3 id="symlinks-to-rescue">Symlinks to Rescue?</h3>
<p>I thought initially it would be an elegant solution, but I have just discovered it doesn&rsquo;t always work.</p>
<h2 id="first-image-comes-free">First Image Comes Free</h2>
<p>Of all images used in an article, there is probably one, that you would like to put on the top of
the content, use when you feature the article on the front page, etc. A theme-setting thing. We can
simplify our lives one step further, if we agree on a &lsquo;magic&rsquo; name for such composite resource, and
include it in our template(s) as a partial with the following content:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">{{ $c := &#34;&#34; }}
{{ with .Resources.GetMatch &#34;main-img/caption.*&#34; }}
{{- $c = trim .Plain &#34;\n&#34;  -}}
{{end}}
{{ with .Resources.GetMatch &#34;main-img/*.jpg&#34; }}
<span class="p">&lt;</span><span class="nt">figure</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;main&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;{{ .Permalink }}&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;{{$c}}&#34;</span><span class="p">&gt;</span>
    {{ if $c }}
    <span class="p">&lt;</span><span class="nt">figcaption</span><span class="p">&gt;</span>
        {{ $c }}
    <span class="p">&lt;/</span><span class="nt">figcaption</span><span class="p">&gt;</span>
    {{ end }}
<span class="p">&lt;/</span><span class="nt">figure</span><span class="p">&gt;</span>
{{ end }}
</code></pre></div><p>Save it under <code>themes/&lt;THEME NAME&gt;/layouts/partials/main_img.html</code>, and then include it into, say,
<code>single.html</code> like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">{{ define &#34;main&#34; }}
    <span class="p">&lt;</span><span class="nt">article</span><span class="p">&gt;</span>
        {{ partial &#34;main_img.html&#34; . }}
        {{ .Content }}
    <span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
    {{ partial &#34;disqus.html&#34; . }}
{{ end }}
</code></pre></div><p>Now, for the first (main) image, you don&rsquo;t have to make any edits to your Markdown at all. All you
need to do is to create a symlink with a certain name. And thanks to the &lsquo;magic&rsquo; name,
you can include this composite resource elsewhere - on a front page, for
instance – without making any additional edits. And given that often times one single image in
an article is all we need&hellip;</p>
<p>Dare I call it &lsquo;efficient&rsquo;?</p>

        <nav class="nextprev">

<p class="next">
    <a href="https://vendelin.org/geeky/hugo/summary-linktitle-hugo/">
         Featured Content, Page Summary, Link Texts &rarr;
    </a>
</p>


<p class="prev">
    <a href="https://vendelin.org/geeky/hugo/create-multilingual-content-hugo/">
         &larr; Multilingual Content With Hugo
    </a>
</p>

</nav>
<div id="disqus_thread"></div>
    </article><script>
function disqus() {

    var disqus_config = function () {
        this.page.url = "https://vendelin.org/geeky/hugo/images-multilingual-pages-hugo/";  
        this.page.identifier = "bc9516c2dbfd5ccd98772e2784fce292";   
    };
    (function() {  
        var d = document, s = d.createElement('script');

        s.src = 'https://vendelin-org.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();

}

window.addEventListener('load', function(event){
    var decn = cookieDecision();

    if(decn) {
        const accept = decn.split('=')[1];
        if( accept == 1 ){
            disqus();
        }
    }

    document.getElementById('accept').addEventListener('click', function (){
        disqus();
    });
});
</script></main>
        </div><div id="gdpr" style="display: none">
    <div class="cookie-consent">
        <p>
            We use third-party cookies for analytics and comments. Disabling cookies disables comments.
        </p>
        <a id="reject" href="#">Reject</a>
        <a id="accept" href="#">Accept</a>
    </div>
</div>
</body>
</html>
